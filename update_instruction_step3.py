#!/usr/bin/env python3
"""
–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∑–µ—Ä–∫–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –º–æ–∑–≥–æ—Ä–∏—Ç–º–æ–≤ 3-–≥–æ —à–∞–≥–∞
"""

import json
import re

# –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
NEW_SECTION = """

### 4. –û–°–û–ë–û–ï –ü–†–ê–í–ò–õ–û: –ú–æ–∑–≥–æ—Ä–∏—Ç–º "–æ—Ç –ª–∏—Ü–∞ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞" (3 —à–∞–≥)

‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û –¥–ª—è –º–æ–∑–≥–æ—Ä–∏—Ç–º–æ–≤ 3-–≥–æ —à–∞–≥–∞:**

–ï—Å–ª–∏ –º–æ–∑–≥–æ—Ä–∏—Ç–º –Ω–∞–ø–∏—Å–∞–Ω **–æ—Ç –ª–∏—Ü–∞ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞** (–Ω–∞—á–∞–ª—å–Ω–∏–∫, —Ä–æ–¥–∏—Ç–µ–ª—å, –ø–∞—Ä—Ç–Ω—ë—Ä, –¥—Ä—É–≥), –í–°–ï –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –ø—É–Ω–∫—Ç 4 –î–û–õ–ñ–ù–´:

1. **–ó–ï–†–ö–ê–õ–¨–ù–û –æ—Ç—Ä–∞–∂–∞—Ç—å –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏** –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ 1-2, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ —Ç–æ–∫—Å–∏—á–Ω—ã–µ/–∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ/–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ
2. **–ù–ï "—É–ª—É—á—à–∞—Ç—å" –∏–ª–∏ "—Å–º—è–≥—á–∞—Ç—å"** –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¢–û–ß–ù–´–ï —Å–ª–æ–≤–∞ –∏ —Å–∏—Ç—É–∞—Ü–∏–∏** –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ 1-2
4. **–ù–ï –¥–æ–±–∞–≤–ª—è—Ç—å** –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ, –Ω–æ –Ω–µ —É–ø–æ–º—è–Ω—É—Ç—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

**–¶–µ–ª—å –º–µ—Ç–æ–¥–∏–∫–∏:** –£—á–µ–Ω–∏—Ü–∞ –¥–æ–ª–∂–Ω–∞ –û–°–û–ó–ù–ê–¢–¨ —Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç—å/–Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å –ø—Ä–µ—Ç–µ–Ω–∑–∏–π –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ —á–µ—Ä–µ–∑ –∏—Ö —Ç–æ—á–Ω—É—é —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É!

---

**–ü–†–ò–ú–ï–† 1: –¢–æ–∫—Å–∏—á–Ω—ã–π –Ω–∞—á–∞–ª—å–Ω–∏–∫ (–ü–†–ê–í–ò–õ–¨–ù–û)**

–ú–æ–∑–≥–æ—Ä–∏—Ç–º –æ—Ç –ª–∏—Ü–∞ –Ω–∞—á–∞–ª—å–Ω–∏–∫–∞ –∫ —Å–æ—Ç—Ä—É–¥–Ω–∏—Ü–µ:
- –ü—É–Ω–∫—Ç 1: "–•–æ—Ç–µ–ª–æ—Å—å, —á—Ç–æ–±—ã –æ–Ω–∞ –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –ø—Ä–æ—Å–∏—Ç—å –ø–æ–≤—ã—à–µ–Ω–∏–µ –∑–∞—Ä–ø–ª–∞—Ç—ã, —Ä–∞–±–æ—Ç–∞–ª–∞ –±—ã—Å—Ç—Ä–æ, –±—ã–ª–∞ —É–¥–æ–±–Ω–æ–π"
- –ü—É–Ω–∫—Ç 2: "–ù–µ —Ö–æ—Ç–µ–ª–æ—Å—å, —á—Ç–æ–±—ã –æ–Ω–∞ –æ—Å–ø–∞—Ä–∏–≤–∞–ª–∞ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ, –≥–æ–≤–æ—Ä–∏–ª–∞ –ø—Ä–æ –±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã"
- –ü—É–Ω–∫—Ç 3: "–ù–µ –ø—Ä–∏—è—Ç–Ω–æ, —á—Ç–æ –æ—Å–ø–∞—Ä–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –º–Ω–æ–≥–∏–µ –±–µ–∑–≥—Ä–∞–º–æ—Ç–Ω—ã–µ –¥–µ–ª–∏—à–∫–∏"

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ï –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –ø—É–Ω–∫—Ç 4 (–∑–µ—Ä–∫–∞–ª–æ –ø—Ä–µ—Ç–µ–Ω–∑–∏–π):

- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –æ—Å–ø–∞—Ä–∏–≤–∞—Ç—å –º–æ–∏ —Ä–µ—à–µ–Ω–∏—è;
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –Ω–µ —Å—Å—ã–ª–∞–ª–∞—Å—å –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –Ω–∞ –∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ;
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä–æ –±–æ–ª—å—à–æ–π –æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã;
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –Ω–µ —Ç–æ—Ä–º–æ–∑–∏–ª–∞ –º–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã —Å–≤–æ–∏–º–∏ –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è–º–∏.

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è (—Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ):

- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –Ω–∞—É—á–∏–ª–∞—Å—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å —Å–≤–æ—ë –≤—Ä–µ–º—è ‚Üê (–ù–ï –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!)
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –Ω–∞—Ö–æ–¥–∏–ª–∞ –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–∞–±–æ—Ç–æ–π –∏ –ª–∏—á–Ω–æ–π –∂–∏–∑–Ω—å—é ‚Üê (–ù–ï –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!)
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –ø—Ä–æ—è–≤–ª—è–ª–∞ –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É ‚Üê (–ù–ï –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!)

**–ü–æ—á–µ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã "–æ—Å–ø–∞—Ä–∏–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è", "–∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ", "–æ–±—ä—ë–º —Ä–∞–±–æ—Ç—ã", "—Ç–æ—Ä–º–æ–∑–∏—Ç—å –ø—Ä–æ–µ–∫—Ç—ã" ‚Äî –ø—Ä—è–º–æ –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ 1-3.

---

**–ü–†–ò–ú–ï–† 2: –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∞—è –º–∞—Ç—å (–ü–†–ê–í–ò–õ–¨–ù–û)**

–ú–æ–∑–≥–æ—Ä–∏—Ç–º –æ—Ç –ª–∏—Ü–∞ –º–∞—Ç–µ—Ä–∏ –∫ –≤–∑—Ä–æ—Å–ª–æ–π –¥–æ—á–µ—Ä–∏:
- –ü—É–Ω–∫—Ç 1: "–•–æ—Ç–µ–ª–æ—Å—å –±—ã, —á—Ç–æ–±—ã –¥–æ—á—å –ø—Ä–∏—Å–ª—É—à–∏–≤–∞–ª–∞—Å—å –∫ –º–æ–∏–º —Å–æ–≤–µ—Ç–∞–º –ø—Ä–æ –ø–∞—Ä–Ω—è, –Ω–µ –≥—Ä—É–±–∏–ª–∞"
- –ü—É–Ω–∫—Ç 2: "–ù–µ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã, —á—Ç–æ–±—ã –æ–Ω–∞ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∞ –º–æ–∏ –∑–≤–æ–Ω–∫–∏, –≤—Å—Ç—Ä–µ—á–∞–ª–∞—Å—å —Å —ç—Ç–∏–º –ø–∞—Ä–Ω–µ–º"
- –ü—É–Ω–∫—Ç 3: "–ù–µ –ø—Ä–∏—è—Ç–Ω–æ, —á—Ç–æ –æ–Ω–∞ –≥—Ä—É–±–∏—Ç, –∫–æ–≥–¥–∞ —è –ø—ã—Ç–∞—é—Å—å –ø–æ–º–æ—á—å"

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ï –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è:

- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –ø—Ä–∏—Å–ª—É—à–∏–≤–∞–ª–∞—Å—å –∫ –º–æ–∏–º —Å–æ–≤–µ—Ç–∞–º –ø—Ä–æ –ø–∞—Ä–Ω—è;
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –Ω–µ –≥—Ä—É–±–∏–ª–∞, –∫–æ–≥–¥–∞ —è –∑–≤–æ–Ω—é;
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –ø–µ—Ä–µ—Å—Ç–∞–ª–∞ –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è —Å —ç—Ç–∏–º –ø–∞—Ä–Ω–µ–º;
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª–∞ –º–æ–∏ –∑–≤–æ–Ω–∫–∏.

‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–´–ï –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è:

- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã —Å—Ç—Ä–æ–∏–ª–∞ –∑–¥–æ—Ä–æ–≤—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã ‚Üê (–ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ –ù–ï –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞!)
- –µ—Å–ª–∏ –±—ã –æ–Ω–∞ —Ö–æ—Ç—è –±—ã —É–≤–∞–∂–∞–ª–∞ –º–æ—ë –º–Ω–µ–Ω–∏–µ ‚Üê (—Å–ª–∏—à–∫–æ–º –æ–±—â–µ–µ!)

---

**–ü–†–ò–ú–ï–† 3: –û–±–∏–∂–µ–Ω–Ω—ã–π –ø–∞—Ä—Ç–Ω—ë—Ä (–ü–†–ê–í–ò–õ–¨–ù–û)**

–ú–æ–∑–≥–æ—Ä–∏—Ç–º –æ—Ç –ª–∏—Ü–∞ –ø–∞—Ä—Ç–Ω—ë—Ä–∞:
- –ü—É–Ω–∫—Ç 1: "–•–æ—Ç–µ–ª–æ—Å—å –±—ã, —á—Ç–æ–±—ã –æ–Ω –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–≤–æ–¥–∏–ª –¥–æ–º–∞, –∞ –Ω–µ —Å –¥—Ä—É–∑—å—è–º–∏ –Ω–∞ —Ñ—É—Ç–±–æ–ª–µ"
- –ü—É–Ω–∫—Ç 2: "–ù–µ —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã, —á—Ç–æ–±—ã –æ–Ω —É—Ö–æ–¥–∏–ª –Ω–∞ —Ñ—É—Ç–±–æ–ª –∫–∞–∂–¥—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ"
- –ü—É–Ω–∫—Ç 3: "–ù–µ –ø—Ä–∏—è—Ç–Ω–æ, —á—Ç–æ –æ–Ω –≤—Å–µ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–µ—Ç –¥—Ä—É–∑–µ–π –∏ —Ñ—É—Ç–±–æ–ª, –∞ –Ω–µ –º–µ–Ω—è"

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ï –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è:

- –µ—Å–ª–∏ –±—ã –æ–Ω —Ö–æ—Ç—è –±—ã –ø–µ—Ä–µ—Å—Ç–∞–ª —Ö–æ–¥–∏—Ç—å –Ω–∞ —Ñ—É—Ç–±–æ–ª –∫–∞–∂–¥—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ;
- –µ—Å–ª–∏ –±—ã –æ–Ω —Ö–æ—Ç—è –±—ã –ø—Ä–æ–≤–æ–¥–∏–ª –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ –º–Ω–æ–π, –∞ –Ω–µ —Å –¥—Ä—É–∑—å—è–º–∏;
- –µ—Å–ª–∏ –±—ã –æ–Ω —Ö–æ—Ç—è –±—ã –∏–Ω–æ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–ª –º–µ–Ω—è –≤–º–µ—Å—Ç–æ —Ñ—É—Ç–±–æ–ª–∞;
- –µ—Å–ª–∏ –±—ã –æ–Ω —Ö–æ—Ç—è –±—ã –æ—Ç–∫–∞–∑—ã–≤–∞–ª—Å—è –æ—Ç –¥—Ä—É–∑–µ–π —Ä–∞–¥–∏ –º–µ–Ω—è.

---

**–ê–õ–ì–û–†–ò–¢–ú –¥–ª—è –º–æ–∑–≥–æ—Ä–∏—Ç–º–æ–≤ "–æ—Ç –ª–∏—Ü–∞ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞":**

1Ô∏è‚É£ **–û–ø—Ä–µ–¥–µ–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ 3-–≥–æ —à–∞–≥–∞:**
   - –§—Ä–∞–∑—ã —Ç–∏–ø–∞ "–æ—Ç –ª–∏—Ü–∞ [—á–µ–ª–æ–≤–µ–∫–∞]", "–∫–∞–∫ –±—ã —è —Ö–æ—Ç–µ–ª–∞, —á—Ç–æ–±—ã [–æ–Ω–∞/–æ–Ω]..."
   - –ü—Ä–µ—Ç–µ–Ω–∑–∏–∏ –ö –∫–æ–º—É-—Ç–æ (–∞ –Ω–µ –∫ —Å–µ–±–µ)
   - –û–∂–∏–¥–∞–Ω–∏—è –û–¢ –¥—Ä—É–≥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞

2Ô∏è‚É£ **–ò–∑–≤–ª–µ–∫–∏ –í–°–ï –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏ –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ 1-2:**
   - –î–µ–π—Å—Ç–≤–∏—è: "–æ—Å–ø–∞—Ä–∏–≤–∞–µ—Ç", "–ø—Ä–æ—Å–∏—Ç", "–≥—Ä—É–±–∏—Ç", "–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç"
   - –°–∏—Ç—É–∞—Ü–∏–∏: "–∑–∞–∫–æ–Ω–æ–¥–∞—Ç–µ–ª—å—Å—Ç–≤–æ", "–∑–∞—Ä–ø–ª–∞—Ç–∞", "–∑–≤–æ–Ω–∫–∏", "—Ñ—É—Ç–±–æ–ª"
   - –õ—é–¥–µ–π: "–ø–∞—Ä–µ–Ω—å", "–¥—Ä—É–∑—å—è", "—Å–æ—Ç—Ä—É–¥–Ω–∏—Ü–∞"

3Ô∏è‚É£ **–î–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏ —Å–æ–∑–¥–∞–π —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫—É:**
   "–µ—Å–ª–∏ –±—ã [–æ–Ω/–æ–Ω–∞] —Ö–æ—Ç—è –±—ã [–∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –ø—Ä–µ—Ç–µ–Ω–∑–∏—è –∏–∑ –ø—É–Ω–∫—Ç–∞ 1-2]"

4Ô∏è‚É£ **–ó–ê–ü–†–ï–©–ï–ù–û:**
   - ‚ùå –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–µ –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ 1-2)
   - ‚ùå "–£–ª—É—á—à–∞—Ç—å" –∏–ª–∏ "—Å–º—è–≥—á–∞—Ç—å" —Ç–æ–∫—Å–∏—á–Ω—ã–µ –ø—Ä–µ—Ç–µ–Ω–∑–∏–∏
   - ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ ("–±–∞–ª–∞–Ω—Å", "–≥—Ä–∞–Ω–∏—Ü—ã", "—Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ")
   - ‚ùå –ó–∞–º–µ–Ω—è—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Å–ª–æ–≤–∞ –Ω–∞ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ

5Ô∏è‚É£ **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π –¢–û–ß–ù–´–ï —Å–ª–æ–≤–∞ –∏–∑ –º–æ–∑–≥–æ—Ä–∏—Ç–º–∞
   - ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏ –≤—Å–µ—Ö —É–ø–æ–º—è–Ω—É—Ç—ã—Ö –ª—é–¥–µ–π, —Å–∏—Ç—É–∞—Ü–∏–∏, –¥–µ–π—Å—Ç–≤–∏—è
   - ‚úÖ –û—Ç—Ä–∞–∑–∏ –ø—Ä–µ—Ç–µ–Ω–∑–∏—é –ö–ê–ö –ï–°–¢–¨, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∞ —Ç–æ–∫—Å–∏—á–Ω–∞—è

‚ö†Ô∏è **–ü–û–ú–ù–ò:** –≠—Ç–æ –ù–ï –ø—Ä–æ "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ" —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏, –∞ –ø—Ä–æ –û–¢–†–ê–ñ–ï–ù–ò–ï —á—É–∂–∏—Ö –ø—Ä–µ—Ç–µ–Ω–∑–∏–π –¥–ª—è –æ—Å–æ–∑–Ω–∞–Ω–∏—è –∏—Ö –∞–±—Å—É—Ä–¥–Ω–æ—Å—Ç–∏/—Ç–æ–∫—Å–∏—á–Ω–æ—Å—Ç–∏!

---
"""

def add_step3_rule():
    """–î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è 3-–≥–æ —à–∞–≥–∞ –º–æ–∑–≥–æ—Ä–∏—Ç–º–æ–≤"""

    # 1. –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª
    with open('data/instruction.json', 'r', encoding='utf-8') as f:
        data = json.load(f)

    instruction = data['system_instruction']

    # 2. –ù–∞—Ö–æ–¥–∏–º –º–µ—Å—Ç–æ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
    # –ò—â–µ–º –∫–æ–Ω–µ—Ü —Ä–∞–∑–¥–µ–ª–∞ "–ê–ù–ê–õ–ò–ó –ö–û–ù–¢–ï–ö–°–¢–ê –ú–û–ó–ì–û–†–ò–¢–ú–ê"
    # –≠—Ç–æ –ø–æ—Å–ª–µ "**–ü–†–ê–í–ò–õ–û:** –ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä..." –∏ –ø–µ—Ä–µ–¥ "## üí¨ –ö–û–ù–¢–ï–ö–°–¢ –î–ò–ê–õ–û–ì–ê"

    pattern = r'(\*\*–ü–†–ê–í–ò–õ–û:\*\* –ö–∞–∂–¥—ã–π –ø—Ä–∏–º–µ—Ä "–µ—Å–ª–∏ –±—ã —è —Ö–æ—Ç—è –±—ã" –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å–ª–æ–≤–∞/—Å–∏—Ç—É–∞—Ü–∏–∏ –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ 1-2 —É—á–µ–Ω–∏—Ü—ã!\n\n---\n)'

    if re.search(pattern, instruction):
        # –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é –ø–æ—Å–ª–µ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞
        instruction = re.sub(
            pattern,
            r'\1' + NEW_SECTION + '\n',
            instruction,
            count=1
        )

        print("‚úÖ –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ—Å–ª–µ —Ä–∞–∑–¥–µ–ª–∞ '–ê–ù–ê–õ–ò–ó –ö–û–ù–¢–ï–ö–°–¢–ê –ú–û–ó–ì–û–†–ò–¢–ú–ê'")
    else:
        print("‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω –ø–∞—Ç—Ç–µ—Ä–Ω –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏")
        return False

    # 3. –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Ñ–∞–π–ª
    data['system_instruction'] = instruction

    with open('data/instruction.json', 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print("‚úÖ –§–∞–π–ª data/instruction.json –æ–±–Ω–æ–≤–ª—ë–Ω")
    return True

if __name__ == '__main__':
    success = add_step3_rule()
    if success:
        print("\nüìã –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ:")
        print("   - –ü—Ä–∞–≤–∏–ª–æ –∑–µ—Ä–∫–∞–ª—å–Ω–æ–≥–æ –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –º–æ–∑–≥–æ—Ä–∏—Ç–º–æ–≤ 3-–≥–æ —à–∞–≥–∞")
        print("   - 3 –ø—Ä–∏–º–µ—Ä–∞ (–Ω–∞—á–∞–ª—å–Ω–∏–∫, –º–∞—Ç—å, –ø–∞—Ä—Ç–Ω—ë—Ä)")
        print("   - –ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–∑ 5 —à–∞–≥–æ–≤")
        print("   - –ó–∞–ø—Ä–µ—Ç—ã –Ω–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —Ç–æ–∫—Å–∏—á–Ω—ã—Ö –ø—Ä–µ—Ç–µ–Ω–∑–∏–π")
